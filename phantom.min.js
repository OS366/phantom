!function(n){"use strict";var r=n.phantom||{};function t(n){var r=n||"Invalid operation";throw function(n){"undefined"!=typeof logger&&logger.error("[phantom] "+n)}(r),new Error(r)}function e(n){try{if("channelMap"===n)return channelMap;if("globalMap"===n)return globalMap;if("connectorMap"===n)return connectorMap;if("responseMap"===n)return responseMap;if("configurationMap"===n)return configurationMap}catch(n){}return null}function i(n){try{if("undefined"!=typeof java&&java.lang&&java.lang.String)return java.lang.String.valueOf(n)}catch(n){}return String(n)}function o(n,r){if(!n)return t("Map is null or undefined");if(null==r)return t("Key is null or undefined");try{if(n.get)return n.get(i(r))}catch(n){return t("Failed to get from map: "+(n.message||String(n)))}return t("Map does not support get operation")}function a(n,r,a){function u(){if(r&&!function(){try{return"undefined"!=typeof responseMap}catch(n){return!1}}())return t("Response map is only available in response context");var i=e(n);return i||t("Map '"+n+"' is not available")}return{save:function(n,r){return a?t("Map is read-only"):function(n,r,e){if(!n)return t("Map is null or undefined");if(null==r)return t("Key is null or undefined");var o=i(r);try{if(n.put)return void n.put(o,e);if(n.set)return void n.set(o,e)}catch(n){return t("Failed to save to map: "+(n.message||String(n)))}return t("Map does not support put or set operations")}(u(),n,r)},get:function(n){return o(u(),n)},exists:function(n){try{var r=u().get(i(n));return null!=r}catch(n){return t("Failed to check if key exists: "+(n.message||String(n)))}},delete:function(n){return a?t("Map is read-only"):function(n,r){if(!n)return t("Map is null or undefined");if(null==r)return t("Key is null or undefined");try{var e=i(r);if(n.remove)return void n.remove(e);if(n.put)return void n.put(e,null);if(n.set)return void n.set(e,null)}catch(n){return t("Failed to delete from map: "+(n.message||String(n)))}return t("Map does not support remove, put, or set operations")}(u(),n)}}}function u(n){return null==n?"":String(n)}function s(n){if(null==n)return t("Value is null or undefined");var r=Number(n);return isNaN(r)||!isFinite(r)?t("Value is not a valid number: "+String(n)):r}function l(n){try{return null==n?t("Object is null or undefined"):JSON.stringify(n)}catch(n){return t("Failed to stringify JSON: "+(n.message||String(n)))}}n.phantom=r,r.version="0.1.1",r.config={silent:!0},r.init=function(n){return"boolean"==typeof(n=n||{}).silent&&(r.config.silent=n.silent),r},r.maps={},r.maps.channel=a("channelMap",!1,!1),r.maps.global=a("globalMap",!1,!1),r.maps.connector=a("connectorMap",!1,!1),r.maps.response=a("responseMap",!0,!1),r.maps.configuration={get:function(n){var r=e("configurationMap");return r?o(r,n):t("Configuration map is not available")},exists:function(n){try{var r=e("configurationMap");if(!r)return t("Configuration map is not available");var o=r.get(i(n));return null!=o}catch(n){return t("Failed to check if configuration key exists: "+(n.message||String(n)))}},save:function(){return t("Configuration map is read-only")},delete:function(){return t("Configuration map is read-only")}},r.strings={operation:{}},r.strings.operation.find=function(n,r){var t=u(n),e=u(r);return 0!==e.length&&-1!==t.indexOf(e)},r.strings.operation.leftPad=function(n,r,t){var e=u(n),i=u(r||" "),o=parseInt(t,10);if(isNaN(o)||o<=0)return e;for(var a="",s=0;s<o;s++)a+=i;return a+e},r.strings.operation.rightPad=function(n,r,t){var e=u(n),i=u(r||" "),o=parseInt(t,10);if(isNaN(o)||o<=0)return e;for(var a=e,s=0;s<o;s++)a+=i;return a},r.strings.operation.dualPad=function(n,r,t){var e=u(n),i=u(r||" "),o=parseInt(t,10);if(isNaN(o)||o<=0)return e;for(var a="",s=0;s<o;s++)a+=i;return a+e+a},r.strings.operation.leftTrim=function(n){return u(n).replace(/^[ \t\r\n]+/,"")},r.strings.operation.rightTrim=function(n){return u(n).replace(/[ \t\r\n]+$/,"")},r.strings.operation.trim=function(n){return r.strings.operation.leftTrim(r.strings.operation.rightTrim(n))},r.strings.operation.split=function(n,r){return u(n).split(u(r))},r.strings.operation.splice=function(n,r,t,e){var i=u(n),o=parseInt(r,10),a=parseInt(t,10);(isNaN(o)||o<0)&&(o=0),(isNaN(a)||a<0)&&(a=0);var s=u(e||"");return i.slice(0,o)+s+i.slice(o+a)},r.strings.operation.compare=function(n,r){var t=u(n),e=u(r);return t===e?0:t>e?1:-1},r.strings.operation.join=function(n,r,t){return u(n)+u(t||"")+u(r)},r.strings.operation.replace=function(n,r,t){var e=u(n),i=u(r),o=u(t);return 0===i.length?e:e.replace(i,o)},r.strings.operation.replaceAll=function(n,r,t){var e=u(n),i=u(r),o=u(t);if(0===i.length)return e;var a=new RegExp(i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g");return e.replace(a,o)},r.strings.operation.substring=function(n,r,t){var e=u(n),i=parseInt(r,10),o=null!=t?parseInt(t,10):void 0;return isNaN(i)&&(i=0),null!=o&&isNaN(o)&&(o=void 0),null==o?e.substring(i):e.substring(i,o)},r.strings.operation.toUpperCase=function(n){return u(n).toUpperCase()},r.strings.operation.toLowerCase=function(n){return u(n).toLowerCase()},r.strings.operation.capitalize=function(n){var r=u(n);return 0===r.length?r:r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()},r.strings.operation.reverse=function(n){for(var r=u(n),t="",e=r.length-1;e>=0;e--)t+=r.charAt(e);return t},r.strings.operation.length=function(n){return u(n).length},r.strings.operation.startsWith=function(n,r){var t=u(n),e=u(r);return 0===t.indexOf(e)},r.strings.operation.endsWith=function(n,r){var t=u(n),e=u(r);return 0===e.length||t.lastIndexOf(e)===t.length-e.length},r.strings.operation.contains=function(n,t){return r.strings.operation.find(n,t)},r.strings.operation.repeat=function(n,r){var t=u(n),e=parseInt(r,10);if(isNaN(e)||e<=0)return"";for(var i="",o=0;o<e;o++)i+=t;return i},r.strings.operation.remove=function(n,t){return r.strings.operation.replaceAll(n,t,"")},r.strings.operation.isEmpty=function(n){return 0===u(n).length},r.strings.operation.isBlank=function(n){var r=u(n);return 0===r.length||/^\s*$/.test(r)},r.numbers={operation:{}},r.numbers.operation.parse=function(n){return s(n)},r.numbers.operation.isNumber=function(n){try{var r=Number(n);return!(isNaN(r)||!isFinite(r))}catch(n){return!1}},r.numbers.operation.add=function(n,r){return s(n)+s(r)},r.numbers.operation.subtract=function(n,r){return s(n)-s(r)},r.numbers.operation.multiply=function(n,r){return s(n)*s(r)},r.numbers.operation.divide=function(n,r){var e=s(r);return 0===e?t("Division by zero"):s(n)/e},r.numbers.operation.round=function(n,r){var t=s(n),e=s(null==r?0:r),i=Math.pow(10,e);return Math.round(t*i)/i},r.numbers.operation.min=function(n,r){var t=s(n),e=s(r);return t<e?t:e},r.numbers.operation.max=function(n,r){var t=s(n),e=s(r);return t>e?t:e},r.numbers.operation.abs=function(n){return Math.abs(s(n))},r.numbers.operation.ceil=function(n){return Math.ceil(s(n))},r.numbers.operation.floor=function(n){return Math.floor(s(n))},r.numbers.operation.sqrt=function(n){var r=s(n);return r<0?t("Cannot calculate square root of negative number: "+r):Math.sqrt(r)},r.numbers.operation.pow=function(n,r){return Math.pow(s(n),s(r))},r.numbers.operation.mod=function(n,r){var e=s(r);return 0===e?t("Modulo by zero"):s(n)%e},r.numbers.operation.random=function(n,r){var e=null!=n?s(n):0,i=null!=r?s(r):1;return e>i?t("Minimum value ("+e+") is greater than maximum value ("+i+")"):Math.random()*(i-e)+e},r.numbers.operation.randomInt=function(n,r){var e=null!=n?s(n):0,i=null!=r?s(r):1;return e>i?t("Minimum value ("+e+") is greater than maximum value ("+i+")"):Math.floor(Math.random()*(Math.floor(i)-Math.ceil(e)+1))+Math.ceil(e)},r.numbers.operation.between=function(n,r,t){var e=s(n),i=s(r),o=s(t);return e>=i&&e<=o},r.numbers.operation.clamp=function(n,r,e){var i=s(n),o=s(r),a=s(e);return o>a?t("Minimum value ("+o+") is greater than maximum value ("+a+")"):i<o?o:i>a?a:i},r.numbers.operation.sign=function(n){var r=s(n);return r>0?1:r<0?-1:0},r.numbers.operation.isEven=function(n){return s(n)%2==0},r.numbers.operation.isOdd=function(n){return s(n)%2!=0},r.numbers.operation.isPositive=function(n){return s(n)>0},r.numbers.operation.isNegative=function(n){return s(n)<0},r.numbers.operation.isZero=function(n){return 0===s(n)},r.numbers.operation.toFixed=function(n,r){var e=s(n),i=null!=r?s(r):0;return i<0||i>20?t("Decimal places must be between 0 and 20, got: "+i):e.toFixed(Math.floor(i))},r.numbers.operation.truncate=function(n){var r=s(n);return r<0?Math.ceil(r):Math.floor(r)},r.json={operation:{}},r.json.operation.parse=function(n){return function(n){try{if(null==n)return t("JSON string is null or undefined");var r=u(n);return 0===r.length?t("JSON string is empty"):JSON.parse(r)}catch(n){return t("Invalid JSON: "+(n.message||String(n)))}}(n)},r.json.operation.stringify=function(n){return l(n)},r.json.operation.get=function(n,r){if(null==n)return t("Object is null or undefined");if(null==r)return t("Key path is null or undefined");var e=u(r);return 0===e.length?t("Key path is empty"):function(n,r){if(null==n)return t("Object is null or undefined");for(var e=r.split("."),i=n,o=0;o<e.length;o++){if(null==i||"object"!=typeof i)return t("Path '"+r+"' is invalid: intermediate value is not an object");var a=e[o];if(!(a in i))return t("Key '"+a+"' not found in path '"+r+"'");if(void 0===(i=i[a]))return t("Value at path '"+r+"' is undefined")}return i}(n,e)},r.json.operation.set=function(n,r,e){if(null==n)return t("Object is null or undefined");if(null==r)return t("Key path is null or undefined");var i=u(r);if(0===i.length)return t("Key path is empty");try{var o=JSON.parse(JSON.stringify(n));return function(n,r,e){if(null==n||"object"!=typeof n)return t();for(var i=r.split("."),o=n,a=0;a<i.length-1;a++){var u=i[a];null!=o[u]&&"object"==typeof o[u]||(o[u]={}),o=o[u]}o[i[i.length-1]]=e}(o,i,e),o}catch(n){return t("Failed to set value at path '"+i+"': "+(n.message||String(n)))}},r.json.operation.has=function(n,r){if(null==n)return t("Object is null or undefined");if(null==r)return t("Key path is null or undefined");var e=u(r);if(0===e.length)return t("Key path is empty");try{for(var i=e.split("."),o=n,a=0;a<i.length;a++){if(null==o||"object"!=typeof o)return!1;var s=i[a];if(!(s in o))return!1;if(void 0===(o=o[s]))return!1}return!0}catch(n){return!1}},r.json.operation.remove=function(n,r){if(null==n)return t("Object is null or undefined");if(null==r)return t("Key path is null or undefined");var e=u(r);if(0===e.length)return t("Key path is empty");try{for(var i=JSON.parse(JSON.stringify(n)),o=e.split("."),a=i,s=0;s<o.length-1;s++){if(null==a||"object"!=typeof a)return t("Path '"+e+"' is invalid: intermediate value is not an object");a=a[o[s]]}return null==a||"object"!=typeof a?t("Path '"+e+"' is invalid: cannot remove from non-object"):(delete a[o[o.length-1]],i)}catch(n){return t("Failed to remove key at path '"+e+"': "+(n.message||String(n)))}},r.json.operation.keys=function(n){if(null==n||"object"!=typeof n)return t("Object is null, undefined, or not an object");if(Array.isArray(n))return t("Cannot get keys from array, use size() for array length");try{return Object.keys(n)}catch(n){return t("Failed to get keys: "+(n.message||String(n)))}},r.json.operation.values=function(n){if(null==n||"object"!=typeof n)return t("Object is null, undefined, or not an object");if(Array.isArray(n))return t("Cannot get values from array");try{for(var r=Object.keys(n),e=[],i=0;i<r.length;i++)e.push(n[r[i]]);return e}catch(n){return t("Failed to get values: "+(n.message||String(n)))}},r.json.operation.size=function(n){if(null==n||"object"!=typeof n)return t("Object is null, undefined, or not an object");if(Array.isArray(n))return n.length;try{return Object.keys(n).length}catch(n){return t("Failed to get size: "+(n.message||String(n)))}},r.json.operation.merge=function(n,r){if(null==n||"object"!=typeof n)return t("First object is null, undefined, or not an object");if(null==r||"object"!=typeof r)return t("Second object is null, undefined, or not an object");if(Array.isArray(n)||Array.isArray(r))return t("Cannot merge arrays, only objects");try{for(var e=JSON.parse(JSON.stringify(n)),i=Object.keys(r),o=0;o<i.length;o++)e[i[o]]=r[i[o]];return e}catch(n){return t("Failed to merge objects: "+(n.message||String(n)))}},r.json.operation.isEmpty=function(n){if(null==n)return!0;if("object"!=typeof n)return t("Value is not an object or array");if(Array.isArray(n))return 0===n.length;try{return 0===Object.keys(n).length}catch(n){return t("Failed to check if empty: "+(n.message||String(n)))}},r.json.operation.isArray=function(n){return null!=n&&Array.isArray(n)},r.json.operation.isObject=function(n){return null!=n&&("object"==typeof n&&!Array.isArray(n))},r.json.operation.toString=function(n){return l(n)},r.json.operation.prettyPrint=function(n,r){try{if(null==n)return t("Object is null or undefined");var e=null!=r?s(r):2;return e<0||e>10?t("Indent size must be between 0 and 10, got: "+e):JSON.stringify(n,null,e)}catch(n){return t("Failed to pretty print JSON: "+(n.message||String(n)))}},r.init({silent:!0})}(this);