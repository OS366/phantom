/*! Phantom.js v0.1.4-BETA - a product by David Labs */
(global=>{var phantom=global.phantom||{};function fail(msg){msg=msg||"Invalid operation";throw"undefined"!=typeof logger&&logger.error("[phantom] "+msg),new Error(msg)}function resolveMap(name){try{if("channelMap"===name)return channelMap;if("globalMap"===name)return globalMap;if("connectorMap"===name)return connectorMap;if("responseMap"===name)return responseMap;if("configurationMap"===name)return configurationMap}catch(e){}return null}function toJavaString(x){try{if("undefined"!=typeof java&&java.lang&&java.lang.String)return java.lang.String.valueOf(x)}catch(e){}return String(x)}function getSafe(m,k){if(!m)return fail("Map is null or undefined");if(null==k)return fail("Key is null or undefined");try{if(m.get)return m.get(toJavaString(k))}catch(e){return fail("Failed to get from map: "+(e.message||String(e)))}return fail("Map does not support get operation")}function mapFacade(mapName,responseOnly,readOnly){function getMap(){return responseOnly&&!(()=>{try{return"undefined"!=typeof responseMap}catch(e){}})()?fail("Response map is only available in response context"):resolveMap(mapName)||fail("Map '"+mapName+"' is not available")}return{save:function(k,v){return readOnly?fail("Map is read-only"):((m,k,v)=>{if(!m)return fail("Map is null or undefined");if(null==k)return fail("Key is null or undefined");k=toJavaString(k);try{if(m.put)return void m.put(k,v);if(m.set)return void m.set(k,v)}catch(e){return fail("Failed to save to map: "+(e.message||String(e)))}return fail("Map does not support put or set operations")})(getMap(),k,v)},get:function(k){return getSafe(getMap(),k)},exists:function(k){try{return null!=getMap().get(toJavaString(k))}catch(e){return fail("Failed to check if key exists: "+(e.message||String(e)))}},delete:function(k){return readOnly?fail("Map is read-only"):((m,k)=>{if(!m)return fail("Map is null or undefined");if(null==k)return fail("Key is null or undefined");try{var jKey=toJavaString(k);if(m.remove)return void m.remove(jKey);if(m.put)return void m.put(jKey,null);if(m.set)return void m.set(jKey,null)}catch(e){return fail("Failed to delete from map: "+(e.message||String(e)))}return fail("Map does not support remove, put, or set operations")})(getMap(),k)}}}function toStr(x){return null==x?"":String(x)}function toNumStrict(x){var n;return null==x?fail("Value is null or undefined"):(n=Number(x),isNaN(n)||!isFinite(n)?fail("Value is not a valid number: "+String(x)):n)}function stringifyJsonSafe(obj){try{return null==obj?fail("Object is null or undefined"):JSON.stringify(obj)}catch(e){return fail("Failed to stringify JSON: "+(e.message||String(e)))}}function stringifyXmlSafe(obj){try{if(null==obj)return fail("XML object is null or undefined");if("string"==typeof obj)return obj;try{var transformer,source,writer,result;if("undefined"!=typeof java&&obj.getDocumentElement)return transformer=javax.xml.transform.TransformerFactory.newInstance().newTransformer(),source=new javax.xml.transform.dom.DOMSource(obj),writer=new java.io.StringWriter,result=new javax.xml.transform.stream.StreamResult(writer),transformer.transform(source,result),writer.toString()}catch(e){return fail("Failed to stringify XML: "+(e.message||String(e)))}return fail("XML stringification not available - Java XML APIs required (OIE/Rhino environment)")}catch(e){return fail("Failed to stringify XML: "+(e.message||String(e)))}}function getJavaLocalDate(dateInput){try{if(null==dateInput)return fail("Date input is null or undefined");try{if("undefined"!=typeof java&&java.time){if(dateInput.getClass&&"java.time.LocalDate"===dateInput.getClass().getName())return dateInput;if(dateInput.getClass&&"java.time.LocalDateTime"===dateInput.getClass().getName())return dateInput.toLocalDate();if("string"==typeof dateInput||dateInput.getClass&&"java.lang.String"===dateInput.getClass().getName()){var s=String(dateInput);if(0===s.length)return fail("Date string is empty");try{return java.time.LocalDate.parse(s)}catch(e){for(var formatters=[java.time.format.DateTimeFormatter.ofPattern("yyyy-MM-dd"),java.time.format.DateTimeFormatter.ofPattern("MM/dd/yyyy"),java.time.format.DateTimeFormatter.ofPattern("dd/MM/yyyy")],i=0;i<formatters.length;i++)try{return java.time.LocalDate.parse(s,formatters[i])}catch(e2){}return fail("Failed to parse date string: "+s)}}var timestamp,instant;if("number"==typeof dateInput||dateInput.getClass&&"java.lang.Long"===dateInput.getClass().getName())return timestamp=Number(dateInput),instant=java.time.Instant.ofEpochMilli(timestamp),java.time.LocalDate.ofInstant(instant,java.time.ZoneId.systemDefault())}}catch(e){}if(dateInput instanceof Date)try{var year,month,day;if("undefined"!=typeof java&&java.time)return year=dateInput.getFullYear(),month=dateInput.getMonth()+1,day=dateInput.getDate(),java.time.LocalDate.of(year,month,day)}catch(e){}return fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get date: "+(e.message||String(e)))}}function getJavaLocalDateTime(dateInput){try{if(null==dateInput)return fail("Date input is null or undefined");try{if("undefined"!=typeof java&&java.time){if(dateInput.getClass&&"java.time.LocalDateTime"===dateInput.getClass().getName())return dateInput;if(dateInput.getClass&&"java.time.LocalDate"===dateInput.getClass().getName())return dateInput.atStartOfDay();if("string"==typeof dateInput||dateInput.getClass&&"java.lang.String"===dateInput.getClass().getName()){var s=String(dateInput);if(0===s.length)return fail("Date string is empty");try{return java.time.LocalDateTime.parse(s)}catch(e){for(var formatters=[java.time.format.DateTimeFormatter.ofPattern("yyyy-MM-dd'T'HH:mm:ss"),java.time.format.DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss"),java.time.format.DateTimeFormatter.ofPattern("MM/dd/yyyy HH:mm:ss")],i=0;i<formatters.length;i++)try{return java.time.LocalDateTime.parse(s,formatters[i])}catch(e2){}return fail("Failed to parse datetime string: "+s)}}var timestamp,instant;if("number"==typeof dateInput||dateInput.getClass&&"java.lang.Long"===dateInput.getClass().getName())return timestamp=Number(dateInput),instant=java.time.Instant.ofEpochMilli(timestamp),java.time.LocalDateTime.ofInstant(instant,java.time.ZoneId.systemDefault())}}catch(e){}if(dateInput instanceof Date)try{var year,month,day,hour,minute,second;if("undefined"!=typeof java&&java.time)return year=dateInput.getFullYear(),month=dateInput.getMonth()+1,day=dateInput.getDate(),hour=dateInput.getHours(),minute=dateInput.getMinutes(),second=dateInput.getSeconds(),java.time.LocalDateTime.of(year,month,day,hour,minute,second)}catch(e){}return fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get datetime: "+(e.message||String(e)))}}function getChronoUnit(unit){if(null==unit)return fail("Unit is null or undefined");unit=String(unit).toUpperCase();try{if("undefined"!=typeof java&&java.time.temporal)return java.time.temporal.ChronoUnit.valueOf(unit)}catch(e){return fail("Invalid unit: "+unit+". Use DAYS, HOURS, MINUTES, SECONDS, MILLIS, WEEKS, MONTHS, or YEARS")}return fail("ChronoUnit not available - Java.time APIs required")}(global.phantom=phantom).version="0.1.4-BETA",phantom.config={silent:!0},phantom.init=function(o){return"boolean"==typeof(o=o||{}).silent&&(phantom.config.silent=o.silent),phantom},phantom.maps={},phantom.maps.channel=mapFacade("channelMap",!1,!1),phantom.maps.global=mapFacade("globalMap",!1,!1),phantom.maps.connector=mapFacade("connectorMap",!1,!1),phantom.maps.response=mapFacade("responseMap",!0,!1),phantom.maps.configuration={get:function(k){var map=resolveMap("configurationMap");return map?getSafe(map,k):fail("Configuration map is not available")},exists:function(k){try{var m=resolveMap("configurationMap");return m?null!=m.get(toJavaString(k)):fail("Configuration map is not available")}catch(e){return fail("Failed to check if configuration key exists: "+(e.message||String(e)))}},save:function(){return fail("Configuration map is read-only")},delete:function(){return fail("Configuration map is read-only")}},phantom.strings={operation:{}},phantom.strings.operation.find=function(input,stringToFind){input=toStr(input),stringToFind=toStr(stringToFind);return 0!==stringToFind.length&&-1!==input.indexOf(stringToFind)},phantom.strings.operation.leftPad=function(input,padChar,count){var input=toStr(input),p=toStr(padChar||" "),n=parseInt(count,10);if(isNaN(n)||n<=0)return input;for(var out="",i=0;i<n;i++)out+=p;return out+input},phantom.strings.operation.rightPad=function(input,padChar,count){var input=toStr(input),p=toStr(padChar||" "),n=parseInt(count,10);if(isNaN(n)||n<=0)return input;for(var out=input,i=0;i<n;i++)out+=p;return out},phantom.strings.operation.dualPad=function(input,padChar,count){var input=toStr(input),p=toStr(padChar||" "),n=parseInt(count,10);if(isNaN(n)||n<=0)return input;for(var pad="",i=0;i<n;i++)pad+=p;return pad+input+pad},phantom.strings.operation.leftTrim=function(input){return toStr(input).replace(/^[ \t\r\n]+/,"")},phantom.strings.operation.rightTrim=function(input){return toStr(input).replace(/[ \t\r\n]+$/,"")},phantom.strings.operation.trim=function(input){return phantom.strings.operation.leftTrim(phantom.strings.operation.rightTrim(input))},phantom.strings.operation.split=function(input,delimiter){return toStr(input).split(toStr(delimiter))},phantom.strings.operation.splice=function(input,start,deleteCount,insertString){input=toStr(input),start=parseInt(start,10),deleteCount=parseInt(deleteCount,10),(isNaN(start)||start<0)&&(start=0),(isNaN(deleteCount)||deleteCount<0)&&(deleteCount=0),insertString=toStr(insertString||"");return input.slice(0,start)+insertString+input.slice(start+deleteCount)},phantom.strings.operation.compare=function(a,b){a=toStr(a),b=toStr(b);return a===b?0:b<a?1:-1},phantom.strings.operation.join=function(a,b,joinCharacters){return toStr(a)+toStr(joinCharacters||"")+toStr(b)},phantom.strings.operation.replace=function(input,searchString,replaceString){input=toStr(input),searchString=toStr(searchString),replaceString=toStr(replaceString);return 0===searchString.length?input:input.replace(searchString,replaceString)},phantom.strings.operation.replaceAll=function(input,searchString,replaceString){var input=toStr(input),searchString=toStr(searchString),replaceString=toStr(replaceString);return 0===searchString.length?input:(searchString=new RegExp(searchString.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),input.replace(searchString,replaceString))},phantom.strings.operation.substring=function(input,start,end){input=toStr(input),start=parseInt(start,10),end=null!=end?parseInt(end,10):void 0;return isNaN(start)&&(start=0),null==(end=null!=end&&isNaN(end)?void 0:end)?input.substring(start):input.substring(start,end)},phantom.strings.operation.toUpperCase=function(input){return toStr(input).toUpperCase()},phantom.strings.operation.toLowerCase=function(input){return toStr(input).toLowerCase()},phantom.strings.operation.capitalize=function(input){input=toStr(input);return 0===input.length?input:input.charAt(0).toUpperCase()+input.slice(1).toLowerCase()},phantom.strings.operation.reverse=function(input){for(var s=toStr(input),result="",i=s.length-1;0<=i;i--)result+=s.charAt(i);return result},phantom.strings.operation.length=function(input){return toStr(input).length},phantom.strings.operation.startsWith=function(input,prefix){input=toStr(input),prefix=toStr(prefix);return 0===input.indexOf(prefix)},phantom.strings.operation.endsWith=function(input,suffix){input=toStr(input),suffix=toStr(suffix);return 0===suffix.length||input.lastIndexOf(suffix)===input.length-suffix.length},phantom.strings.operation.contains=function(input,stringToFind){return phantom.strings.operation.find(input,stringToFind)},phantom.strings.operation.repeat=function(input,count){var s=toStr(input),n=parseInt(count,10);if(isNaN(n)||n<=0)return"";for(var result="",i=0;i<n;i++)result+=s;return result},phantom.strings.operation.remove=function(input,stringToRemove){return phantom.strings.operation.replaceAll(input,stringToRemove,"")},phantom.strings.operation.isEmpty=function(input){return 0===toStr(input).length},phantom.strings.operation.isBlank=function(input){input=toStr(input);return 0===input.length||/^\s*$/.test(input)},phantom.numbers={operation:{}},phantom.numbers.operation.parse=toNumStrict,phantom.numbers.operation.isNumber=function(value){try{var n=Number(value);return!(isNaN(n)||!isFinite(n))}catch(e){return!1}},phantom.numbers.operation.add=function(a,b){return toNumStrict(a)+toNumStrict(b)},phantom.numbers.operation.subtract=function(a,b){return toNumStrict(a)-toNumStrict(b)},phantom.numbers.operation.multiply=function(a,b){return toNumStrict(a)*toNumStrict(b)},phantom.numbers.operation.divide=function(a,b){b=toNumStrict(b);return 0===b?fail("Division by zero"):toNumStrict(a)/b},phantom.numbers.operation.round=function(value,decimals){value=toNumStrict(value),decimals=toNumStrict(null==decimals?0:decimals),decimals=Math.pow(10,decimals);return Math.round(value*decimals)/decimals},phantom.numbers.operation.min=function(a,b){a=toNumStrict(a),b=toNumStrict(b);return a<b?a:b},phantom.numbers.operation.max=function(a,b){a=toNumStrict(a),b=toNumStrict(b);return b<a?a:b},phantom.numbers.operation.abs=function(value){return Math.abs(toNumStrict(value))},phantom.numbers.operation.ceil=function(value){return Math.ceil(toNumStrict(value))},phantom.numbers.operation.floor=function(value){return Math.floor(toNumStrict(value))},phantom.numbers.operation.sqrt=function(value){value=toNumStrict(value);return value<0?fail("Cannot calculate square root of negative number: "+value):Math.sqrt(value)},phantom.numbers.operation.pow=function(base,exponent){return Math.pow(toNumStrict(base),toNumStrict(exponent))},phantom.numbers.operation.mod=function(dividend,divisor){divisor=toNumStrict(divisor);return 0===divisor?fail("Modulo by zero"):toNumStrict(dividend)%divisor},phantom.numbers.operation.random=function(min,max){min=null!=min?toNumStrict(min):0,max=null!=max?toNumStrict(max):1;return max<min?fail("Minimum value ("+min+") is greater than maximum value ("+max+")"):Math.random()*(max-min)+min},phantom.numbers.operation.randomInt=function(min,max){min=null!=min?toNumStrict(min):0,max=null!=max?toNumStrict(max):1;return max<min?fail("Minimum value ("+min+") is greater than maximum value ("+max+")"):Math.floor(Math.random()*(Math.floor(max)-Math.ceil(min)+1))+Math.ceil(min)},phantom.numbers.operation.between=function(value,min,max){value=toNumStrict(value),min=toNumStrict(min),max=toNumStrict(max);return min<=value&&value<=max},phantom.numbers.operation.clamp=function(value,min,max){value=toNumStrict(value),min=toNumStrict(min),max=toNumStrict(max);return max<min?fail("Minimum value ("+min+") is greater than maximum value ("+max+")"):value<min?min:max<value?max:value},phantom.numbers.operation.sign=function(value){value=toNumStrict(value);return 0<value?1:value<0?-1:0},phantom.numbers.operation.isEven=function(value){return toNumStrict(value)%2==0},phantom.numbers.operation.isOdd=function(value){return toNumStrict(value)%2!=0},phantom.numbers.operation.isPositive=function(value){return 0<toNumStrict(value)},phantom.numbers.operation.isNegative=function(value){return toNumStrict(value)<0},phantom.numbers.operation.isZero=function(value){return 0===toNumStrict(value)},phantom.numbers.operation.toFixed=function(value,decimals){value=toNumStrict(value),decimals=null!=decimals?toNumStrict(decimals):0;return decimals<0||20<decimals?fail("Decimal places must be between 0 and 20, got: "+decimals):value.toFixed(Math.floor(decimals))},phantom.numbers.operation.truncate=function(value){value=toNumStrict(value);return value<0?Math.ceil(value):Math.floor(value)},phantom.json={operation:{}},phantom.json.operation.parse=function(jsonString){var s;try{return null==jsonString?fail("JSON string is null or undefined"):0===(s=toStr(jsonString)).length?fail("JSON string is empty"):JSON.parse(s)}catch(e){return fail("Invalid JSON: "+(e.message||String(e)))}},phantom.json.operation.stringify=stringifyJsonSafe,phantom.json.operation.get=function(obj,keyPath){return null==obj?fail("Object is null or undefined"):null==keyPath?fail("Key path is null or undefined"):0===(keyPath=toStr(keyPath)).length?fail("Key path is empty"):((obj,path)=>{if(null==obj)return fail("Object is null or undefined");for(var keys=path.split("."),current=obj,i=0;i<keys.length;i++){if(null==current||"object"!=typeof current)return fail("Path '"+path+"' is invalid: intermediate value is not an object");var key=keys[i];if(!(key in current))return fail("Key '"+key+"' not found in path '"+path+"'");if(void 0===(current=current[key]))return fail("Value at path '"+path+"' is undefined")}return current})(obj,keyPath)},phantom.json.operation.set=function(obj,keyPath,value){if(null==obj)return fail("Object is null or undefined");if(null==keyPath)return fail("Key path is null or undefined");keyPath=toStr(keyPath);if(0===keyPath.length)return fail("Key path is empty");try{var result=JSON.parse(JSON.stringify(obj));return((obj,path,value)=>{if(null==obj||"object"!=typeof obj)return fail();for(var keys=path.split("."),current=obj,i=0;i<keys.length-1;i++){var key=keys[i];null!=current[key]&&"object"==typeof current[key]||(current[key]={}),current=current[key]}current[keys[keys.length-1]]=value})(result,keyPath,value),result}catch(e){return fail("Failed to set value at path '"+keyPath+"': "+(e.message||String(e)))}},phantom.json.operation.has=function(obj,keyPath){if(null==obj)return fail("Object is null or undefined");if(null==keyPath)return fail("Key path is null or undefined");keyPath=toStr(keyPath);if(0===keyPath.length)return fail("Key path is empty");try{for(var keys=keyPath.split("."),current=obj,i=0;i<keys.length;i++){if(null==current||"object"!=typeof current)return!1;var key=keys[i];if(!(key in current))return!1;if(void 0===(current=current[key]))return!1}return!0}catch(e){return!1}},phantom.json.operation.remove=function(obj,keyPath){if(null==obj)return fail("Object is null or undefined");if(null==keyPath)return fail("Key path is null or undefined");var path=toStr(keyPath);if(0===path.length)return fail("Key path is empty");try{for(var result=JSON.parse(JSON.stringify(obj)),keys=path.split("."),current=result,i=0;i<keys.length-1;i++){if(null==current||"object"!=typeof current)return fail("Path '"+path+"' is invalid: intermediate value is not an object");current=current[keys[i]]}return null==current||"object"!=typeof current?fail("Path '"+path+"' is invalid: cannot remove from non-object"):(delete current[keys[keys.length-1]],result)}catch(e){return fail("Failed to remove key at path '"+path+"': "+(e.message||String(e)))}},phantom.json.operation.keys=function(obj){if(null==obj||"object"!=typeof obj)return fail("Object is null, undefined, or not an object");if(Array.isArray(obj))return fail("Cannot get keys from array, use size() for array length");try{return Object.keys(obj)}catch(e){return fail("Failed to get keys: "+(e.message||String(e)))}},phantom.json.operation.values=function(obj){if(null==obj||"object"!=typeof obj)return fail("Object is null, undefined, or not an object");if(Array.isArray(obj))return fail("Cannot get values from array");try{for(var keys=Object.keys(obj),vals=[],i=0;i<keys.length;i++)vals.push(obj[keys[i]]);return vals}catch(e){return fail("Failed to get values: "+(e.message||String(e)))}},phantom.json.operation.size=function(obj){if(null==obj||"object"!=typeof obj)return fail("Object is null, undefined, or not an object");if(Array.isArray(obj))return obj.length;try{return Object.keys(obj).length}catch(e){return fail("Failed to get size: "+(e.message||String(e)))}},phantom.json.operation.merge=function(obj1,obj2){if(null==obj1||"object"!=typeof obj1)return fail("First object is null, undefined, or not an object");if(null==obj2||"object"!=typeof obj2)return fail("Second object is null, undefined, or not an object");if(Array.isArray(obj1)||Array.isArray(obj2))return fail("Cannot merge arrays, only objects");try{for(var result=JSON.parse(JSON.stringify(obj1)),keys=Object.keys(obj2),i=0;i<keys.length;i++)result[keys[i]]=obj2[keys[i]];return result}catch(e){return fail("Failed to merge objects: "+(e.message||String(e)))}},phantom.json.operation.isEmpty=function(obj){if(null==obj)return!0;if("object"!=typeof obj)return fail("Value is not an object or array");if(Array.isArray(obj))return 0===obj.length;try{return 0===Object.keys(obj).length}catch(e){return fail("Failed to check if empty: "+(e.message||String(e)))}},phantom.json.operation.isArray=function(obj){return null!=obj&&Array.isArray(obj)},phantom.json.operation.isObject=function(obj){return null!=obj&&"object"==typeof obj&&!Array.isArray(obj)},phantom.json.operation.toString=stringifyJsonSafe,phantom.json.operation.prettyPrint=function(obj,indent){try{var indentSize;return null==obj?fail("Object is null or undefined"):(indentSize=null!=indent?toNumStrict(indent):2)<0||10<indentSize?fail("Indent size must be between 0 and 10, got: "+indentSize):JSON.stringify(obj,null,indentSize)}catch(e){return fail("Failed to pretty print JSON: "+(e.message||String(e)))}},phantom.base64={operation:{}},phantom.base64.operation.encode=function(str){return(str=>{try{if(null==str)return fail("String is null or undefined");var encoder,bytes,s=toStr(str);try{if("undefined"!=typeof java&&java.util&&java.util.Base64)return encoder=java.util.Base64.getEncoder(),bytes=new java.lang.String(s).getBytes("UTF-8"),encoder.encodeToString(bytes)}catch(e){}if("undefined"!=typeof btoa)try{var utf8=unescape(encodeURIComponent(s));return btoa(utf8)}catch(e){return btoa(s)}for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",result="",i=0;i<s.length;)var bitmap=s.charCodeAt(i++)<<16|(i<s.length?s.charCodeAt(i++):0)<<8|(i<s.length?s.charCodeAt(i++):0),result=(result=(result=(result+=chars.charAt(bitmap>>18&63))+chars.charAt(bitmap>>12&63))+(i-2<s.length?chars.charAt(bitmap>>6&63):"="))+(i-1<s.length?chars.charAt(63&bitmap):"=");return result}catch(e){return fail("Failed to encode base64: "+(e.message||String(e)))}})(str)},phantom.base64.operation.decode=function(str){return(str=>{try{if(null==str)return fail("String is null or undefined");var bytes;if(0===(s=toStr(str)).length)return fail("Base64 string is empty");try{if("undefined"!=typeof java&&java.util&&java.util.Base64)return bytes=java.util.Base64.getDecoder().decode(s),new java.lang.String(bytes,"UTF-8").toString()}catch(e){return fail("Invalid base64 string: "+(e.message||String(e)))}if("undefined"!=typeof atob)try{var decoded=atob(s);try{return decodeURIComponent(escape(decoded))}catch(e){return decoded}}catch(e){return fail("Invalid base64 string: "+(e.message||String(e)))}for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",result="",i=0,s=s.replace(/[^A-Za-z0-9\+\/]/g,"");i<s.length;){var encoded1=chars.indexOf(s.charAt(i++)),encoded2=chars.indexOf(s.charAt(i++)),encoded3=chars.indexOf(s.charAt(i++)),encoded4=chars.indexOf(s.charAt(i++));if(encoded1<0||encoded2<0||encoded3<0||encoded4<0)return fail("Invalid base64 string");var bitmap=encoded1<<18|encoded2<<12|encoded3<<6|encoded4;64!==encoded3&&(result+=String.fromCharCode(bitmap>>16&255)),64!==encoded4&&(result+=String.fromCharCode(bitmap>>8&255)),result+=String.fromCharCode(255&bitmap)}return result}catch(e){return fail("Failed to decode base64: "+(e.message||String(e)))}})(str)},phantom.xml={operation:{}},phantom.xml.operation.parse=function(xmlString){try{if(null==xmlString)return fail("XML string is null or undefined");var factory,builder,reader,s=toStr(xmlString);if(0===s.length)return fail("XML string is empty");try{if("undefined"!=typeof java&&java.io&&java.io.StringReader)return(factory=javax.xml.parsers.DocumentBuilderFactory.newInstance()).setNamespaceAware(!0),builder=factory.newDocumentBuilder(),reader=new java.io.StringReader(s),builder.parse(new org.xml.sax.InputSource(reader))}catch(e){return fail("Failed to parse XML: "+(e.message||String(e)))}return fail("XML parsing not available - Java XML APIs required (OIE/Rhino environment)")}catch(e){return fail("Failed to parse XML: "+(e.message||String(e)))}},phantom.xml.operation.stringify=stringifyXmlSafe,phantom.xml.operation.get=function(xml,xpath){return((xml,xpath)=>{try{if(null==xml)return fail("XML object is null or undefined");if(null==xpath)return fail("XPath is null or undefined");var result,path=toStr(xpath);if(0===path.length)return fail("XPath is empty");try{if("undefined"!=typeof java&&javax.xml.xpath)return null==(result=javax.xml.xpath.XPathFactory.newInstance().newXPath().compile(path).evaluate(xml,javax.xml.xpath.XPathConstants.STRING))||""===result?fail("XPath '"+path+"' not found or empty"):String(result)}catch(e){return fail("XPath evaluation failed: "+(e.message||String(e)))}return fail("XML querying not available - Java XPath APIs required (OIE/Rhino environment)")}catch(e){return fail("Failed to get XML value: "+(e.message||String(e)))}})(xml,xpath)},phantom.xml.operation.has=function(xml,xpath){return((xml,xpath)=>{try{if(null!=xml&&null!=xpath){var path=toStr(xpath);if(0!==path.length)try{if("undefined"!=typeof java&&javax.xml.xpath)return null!=javax.xml.xpath.XPathFactory.newInstance().newXPath().compile(path).evaluate(xml,javax.xml.xpath.XPathConstants.NODE)}catch(e){}}return!1}catch(e){return!1}})(xml,xpath)},phantom.xml.operation.toString=stringifyXmlSafe,phantom.dates={operation:{}},phantom.dates.FORMAT={ISO_DATE:"yyyy-MM-dd",ISO_DATETIME:"yyyy-MM-dd'T'HH:mm:ss",ISO_DATETIME_MS:"yyyy-MM-dd'T'HH:mm:ss.SSS",US_DATE:"MM/dd/yyyy",US_DATETIME:"MM/dd/yyyy HH:mm:ss",EU_DATE:"dd/MM/yyyy",EU_DATETIME:"dd/MM/yyyy HH:mm:ss"},phantom.dates.UNIT={DAYS:"DAYS",HOURS:"HOURS",MINUTES:"MINUTES",SECONDS:"SECONDS",MILLIS:"MILLIS",WEEKS:"WEEKS",MONTHS:"MONTHS",YEARS:"YEARS"},phantom.dates.operation.now=function(){try{return"undefined"!=typeof java&&java.time?java.time.LocalDateTime.now():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get current date: "+(e.message||String(e)))}},phantom.dates.operation.today=function(){try{return"undefined"!=typeof java&&java.time?java.time.LocalDate.now():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get today's date: "+(e.message||String(e)))}},phantom.dates.operation.parse=function(dateString,format){try{if(null==dateString)return fail("Date string is null or undefined");var formatter,s=toStr(dateString);if(0===s.length)return fail("Date string is empty");if("undefined"!=typeof java&&java.time){if(null!=format)return formatter=java.time.format.DateTimeFormatter.ofPattern(toStr(format)),java.time.LocalDate.parse(s,formatter);try{return java.time.LocalDate.parse(s)}catch(e){for(var formatters=[java.time.format.DateTimeFormatter.ofPattern("yyyy-MM-dd"),java.time.format.DateTimeFormatter.ofPattern("MM/dd/yyyy"),java.time.format.DateTimeFormatter.ofPattern("dd/MM/yyyy")],i=0;i<formatters.length;i++)try{return java.time.LocalDate.parse(s,formatters[i])}catch(e2){}return fail("Failed to parse date string: "+s)}}return fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to parse date: "+(e.message||String(e)))}},phantom.dates.operation.parseDateTime=function(dateTimeString,format){try{if(null==dateTimeString)return fail("DateTime string is null or undefined");var formatter,s=toStr(dateTimeString);if(0===s.length)return fail("DateTime string is empty");if("undefined"!=typeof java&&java.time){if(null!=format)return formatter=java.time.format.DateTimeFormatter.ofPattern(toStr(format)),java.time.LocalDateTime.parse(s,formatter);try{return java.time.LocalDateTime.parse(s)}catch(e){for(var formatters=[java.time.format.DateTimeFormatter.ofPattern("yyyy-MM-dd'T'HH:mm:ss"),java.time.format.DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss"),java.time.format.DateTimeFormatter.ofPattern("MM/dd/yyyy HH:mm:ss")],i=0;i<formatters.length;i++)try{return java.time.LocalDateTime.parse(s,formatters[i])}catch(e2){}return fail("Failed to parse datetime string: "+s)}}return fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to parse datetime: "+(e.message||String(e)))}},phantom.dates.operation.format=function(date,format){try{var formatter;return null==date?fail("Date is null or undefined"):null==format?fail("Format is null or undefined"):"undefined"!=typeof java&&java.time?(formatter=java.time.format.DateTimeFormatter.ofPattern(toStr(format)),getJavaLocalDate(date).format(formatter)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to format date: "+(e.message||String(e)))}},phantom.dates.operation.formatDateTime=function(dateTime,format){try{var formatter;return null==dateTime?fail("DateTime is null or undefined"):null==format?fail("Format is null or undefined"):"undefined"!=typeof java&&java.time?(formatter=java.time.format.DateTimeFormatter.ofPattern(toStr(format)),getJavaLocalDateTime(dateTime).format(formatter)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to format datetime: "+(e.message||String(e)))}},phantom.dates.operation.getYear=function(date){try{return null==date?fail("Date is null or undefined"):"undefined"!=typeof java&&java.time?getJavaLocalDate(date).getYear():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get year: "+(e.message||String(e)))}},phantom.dates.operation.getMonth=function(date){try{return null==date?fail("Date is null or undefined"):"undefined"!=typeof java&&java.time?getJavaLocalDate(date).getMonthValue():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get month: "+(e.message||String(e)))}},phantom.dates.operation.getDay=function(date){try{return null==date?fail("Date is null or undefined"):"undefined"!=typeof java&&java.time?getJavaLocalDate(date).getDayOfMonth():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get day: "+(e.message||String(e)))}},phantom.dates.operation.getDayOfWeek=function(date){try{return null==date?fail("Date is null or undefined"):"undefined"!=typeof java&&java.time?getJavaLocalDate(date).getDayOfWeek().toString():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get day of week: "+(e.message||String(e)))}},phantom.dates.operation.add=function(date,amount,unit){try{var localDate,amt,chronoUnit;return null==date?fail("Date is null or undefined"):null==amount?fail("Amount is null or undefined"):null==unit?fail("Unit is null or undefined"):"undefined"!=typeof java&&java.time?(localDate=getJavaLocalDate(date),amt=toNumStrict(amount),chronoUnit=getChronoUnit(unit),localDate.plus(amt,chronoUnit)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to add to date: "+(e.message||String(e)))}},phantom.dates.operation.subtract=function(date,amount,unit){try{var localDate,amt,chronoUnit;return null==date?fail("Date is null or undefined"):null==amount?fail("Amount is null or undefined"):null==unit?fail("Unit is null or undefined"):"undefined"!=typeof java&&java.time?(localDate=getJavaLocalDate(date),amt=toNumStrict(amount),chronoUnit=getChronoUnit(unit),localDate.minus(amt,chronoUnit)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to subtract from date: "+(e.message||String(e)))}},phantom.dates.operation.between=function(date1,date2,unit){try{var localDate1,localDate2;return null==date1?fail("First date is null or undefined"):null==date2?fail("Second date is null or undefined"):null==unit?fail("Unit is null or undefined"):"undefined"!=typeof java&&java.time?(localDate1=getJavaLocalDate(date1),localDate2=getJavaLocalDate(date2),getChronoUnit(unit).between(localDate1,localDate2)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to calculate between dates: "+(e.message||String(e)))}},phantom.dates.operation.isBefore=function(date1,date2){try{var localDate1,localDate2;return null==date1?fail("First date is null or undefined"):null==date2?fail("Second date is null or undefined"):"undefined"!=typeof java&&java.time?(localDate1=getJavaLocalDate(date1),localDate2=getJavaLocalDate(date2),localDate1.isBefore(localDate2)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to compare dates: "+(e.message||String(e)))}},phantom.dates.operation.isAfter=function(date1,date2){try{var localDate1,localDate2;return null==date1?fail("First date is null or undefined"):null==date2?fail("Second date is null or undefined"):"undefined"!=typeof java&&java.time?(localDate1=getJavaLocalDate(date1),localDate2=getJavaLocalDate(date2),localDate1.isAfter(localDate2)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to compare dates: "+(e.message||String(e)))}},phantom.dates.operation.isEqual=function(date1,date2){try{var localDate1,localDate2;return null==date1?fail("First date is null or undefined"):null==date2?fail("Second date is null or undefined"):"undefined"!=typeof java&&java.time?(localDate1=getJavaLocalDate(date1),localDate2=getJavaLocalDate(date2),localDate1.isEqual(localDate2)):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to compare dates: "+(e.message||String(e)))}},phantom.dates.operation.startOfDay=function(date){try{return null==date?fail("Date is null or undefined"):"undefined"!=typeof java&&java.time?getJavaLocalDate(date).atStartOfDay():fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get start of day: "+(e.message||String(e)))}},phantom.dates.operation.endOfDay=function(date){try{return null==date?fail("Date is null or undefined"):"undefined"!=typeof java&&java.time?getJavaLocalDate(date).atTime(23,59,59,999e6):fail("Date operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to get end of day: "+(e.message||String(e)))}},phantom.dates.duration={},phantom.dates.duration.between=function(dateTime1,dateTime2){try{var localDateTime1,localDateTime2;return null==dateTime1?fail("First datetime is null or undefined"):null==dateTime2?fail("Second datetime is null or undefined"):"undefined"!=typeof java&&java.time?(localDateTime1=getJavaLocalDateTime(dateTime1),localDateTime2=getJavaLocalDateTime(dateTime2),java.time.Duration.between(localDateTime1,localDateTime2)):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to calculate duration: "+(e.message||String(e)))}},phantom.dates.duration.of=function(amount,unit){try{var amt,chronoUnit;return null==amount?fail("Amount is null or undefined"):null==unit?fail("Unit is null or undefined"):"undefined"!=typeof java&&java.time?(amt=toNumStrict(amount),chronoUnit=getChronoUnit(unit),java.time.Duration.of(amt,chronoUnit)):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to create duration: "+(e.message||String(e)))}},phantom.dates.duration.add=function(dateTime,duration){try{var localDateTime;return null==dateTime?fail("DateTime is null or undefined"):null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?(localDateTime=getJavaLocalDateTime(dateTime),duration.getClass&&"java.time.Duration"===duration.getClass().getName()?localDateTime.plus(duration):fail("Duration must be a Java Duration object")):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to add duration: "+(e.message||String(e)))}},phantom.dates.duration.subtract=function(dateTime,duration){try{var localDateTime;return null==dateTime?fail("DateTime is null or undefined"):null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?(localDateTime=getJavaLocalDateTime(dateTime),duration.getClass&&"java.time.Duration"===duration.getClass().getName()?localDateTime.minus(duration):fail("Duration must be a Java Duration object")):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to subtract duration: "+(e.message||String(e)))}},phantom.dates.duration.toDays=function(duration){try{return null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?duration.getClass&&"java.time.Duration"===duration.getClass().getName()?duration.toDays():fail("Duration must be a Java Duration object"):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to convert duration to days: "+(e.message||String(e)))}},phantom.dates.duration.toHours=function(duration){try{return null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?duration.getClass&&"java.time.Duration"===duration.getClass().getName()?duration.toHours():fail("Duration must be a Java Duration object"):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to convert duration to hours: "+(e.message||String(e)))}},phantom.dates.duration.toMinutes=function(duration){try{return null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?duration.getClass&&"java.time.Duration"===duration.getClass().getName()?duration.toMinutes():fail("Duration must be a Java Duration object"):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to convert duration to minutes: "+(e.message||String(e)))}},phantom.dates.duration.toSeconds=function(duration){try{return null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?duration.getClass&&"java.time.Duration"===duration.getClass().getName()?duration.toSeconds():fail("Duration must be a Java Duration object"):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to convert duration to seconds: "+(e.message||String(e)))}},phantom.dates.duration.toMillis=function(duration){try{return null==duration?fail("Duration is null or undefined"):"undefined"!=typeof java&&java.time?duration.getClass&&"java.time.Duration"===duration.getClass().getName()?duration.toMillis():fail("Duration must be a Java Duration object"):fail("Duration operations require Java.time APIs (OIE/Rhino environment)")}catch(e){return fail("Failed to convert duration to milliseconds: "+(e.message||String(e)))}},phantom.init({silent:!0})})(this);